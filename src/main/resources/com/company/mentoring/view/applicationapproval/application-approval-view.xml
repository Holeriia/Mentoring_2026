<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://applicationApprovalView.title">

    <data>
        <instance id="applicationDc"
                  class="com.company.mentoring.entity.Application">
            <fetchPlan>
                <property name="initiator">
                    <property name="user" fetchPlan="_instance_name"/>
                </property>
                <property name="title"/>
                <property name="description"/>
                <property name="status"/>
                <property name="clarifications" fetchPlan="_base">
                    <property name="author" fetchPlan="_instance_name"/>
                </property>
            </fetchPlan>
            <loader id="applicationDl"/>
            <collection id="clarificationsDc" property="clarifications"/>
        </instance>
    </data>

    <layout spacing="true">

        <formLayout>
            <responsiveSteps>
                <responsiveStep minWidth="0" columns="1"/>
            </responsiveSteps>

            <textField id="initiatorField"
                       label="Инициатор"
                       dataContainer="applicationDc"
                       property="initiator.user"/>

            <textField id="titleField"
                       label="Название"
                       dataContainer="applicationDc"
                       property="title"/>

            <textArea id="descriptionField"
                      label="Описание"
                      dataContainer="applicationDc"
                      property="description"
                      height="8em"/>


            <h4 text="msg://com.company.mentoring.entity/Application.clarifications"/>
            <dataGrid id="clarificationsDataGrid" dataContainer="clarificationsDc" width="100%" minHeight="20em">
                <actions>
                    <action id="createAction" type="list_create">
                        <properties>
                            <property name="openMode" value="DIALOG"/>
                        </properties>
                    </action>
                    <action id="editAction" type="list_edit">
                        <properties>
                            <property name="openMode" value="DIALOG"/>
                        </properties>
                    </action>
                    <action id="removeAction" type="list_remove"/>
                </actions>
                <columns>
                    <column property="message"/>
                    <column property="createdAt"/>
                    <column property="author"/>
                </columns>
            </dataGrid>

            <hbox width="100%" alignItems="CENTER" spacing="true">

                <textArea
                        id="commentField"
                        label="Комментарий"
                        width="100%"
                        height="6em"/>

                <button
                        id="addCommentBtn"
                        icon="vaadin:arrow-forward"
                        themeNames="icon"/>
            </hbox>
        </formLayout>

        <hbox justifyContent="END" spacing="true">
            <button
                    id="approveBtn"
                    text="msg://Approve"
                    themeNames="primary"/>

            <button
                    id="rejectBtn"
                    text="msg://Reject"
                    themeNames="error"/>

            <button
                    id="commentBtn"
                    text="msg://returnApplication"
                    icon="vaadin:arrow-backward"/>
        </hbox>

    </layout>
</view>